{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "description": "Agape-Care 요양원 ERP 모노레포를 위한 Renovate 설정 파일",

  "extends": [
    "config:base",
    ":dependencyDashboard",
    ":semanticCommits",
    ":separateMultipleMajorReleases",
    ":automergeDisabled",
    "group:monorepos"
  ],

  "enabledManagers": ["pnpm"],
  "timezone": "Asia/Seoul",

  "postUpdateOptions": ["pnpmDedupe"],

  "ignorePaths": [
    "docs/**",
    "dist/**",
    "apps/**/out/**",
    "apps/**/.next/**"
  ],

  "packageRules": [
    {
      "description": "패치 및 마이너 버전 자동 병합",
      "matchUpdateTypes": ["patch", "minor"],
      "automerge": true,
      "automergeType": "branch"
    },

    {
      "description": "Agape-Care 관리자(Admin) 앱 그룹",
      "matchPaths": ["apps/admin/**"],
      "groupName": "admin-app",
      "separateMajorMinor": false
    },
    {
      "description": "Agape-Care 웹(Web) 앱 그룹",
      "matchPaths": ["apps/web/**"],
      "groupName": "web-app",
      "separateMajorMinor": false
    },
    {
      "description": "Agape-Care API 앱 그룹",
      "matchPaths": ["apps/api/**"],
      "groupName": "api-app",
      "separateMajorMinor": false
    },
    {
      "description": "Agape-Care Worker 그룹",
      "matchPaths": ["apps/worker/**"],
      "groupName": "worker-app",
      "separateMajorMinor": false
    },

    {
      "description": "Next.js 관련 패키지 그룹",
      "matchPackagePatterns": [
        "^next$",
        "^@next/",
        "^eslint-config-next$"
      ],
      "groupName": "nextjs",
      "schedule": ["on saturday at 03:00"]
    },

    {
      "description": "React 생태계 패키지 그룹",
      "matchPackagePatterns": [
        "^react$",
        "^react-dom$",
        "^@types/react$",
        "^@types/react-dom$"
      ],
      "groupName": "react",
      "schedule": ["on saturday at 03:00"]
    },

    {
      "description": "UI 라이브러리 (Radix, Tailwind, Lucide 등)",
      "matchPackagePatterns": [
        "^@radix-ui/",
        "^tailwindcss$",
        "^@tailwindcss/",
        "^lucide-react$",
        "^framer-motion$"
      ],
      "groupName": "ui-libs",
      "schedule": ["on saturday at 03:00"]
    },

    {
      "description": "데이터베이스 / ORM 관련",
      "matchPackagePatterns": [
        "^prisma$",
        "^@prisma/",
      ],
      "groupName": "database",
      "schedule": ["on saturday at 03:00"]
    },

    {
      "description": "인증·보안 관련 패키지",
      "matchPackagePatterns": [
        "^next-auth$",
        "^@auth/",
        "^bcryptjs$",
        "^jsonwebtoken$",
        "^crypto-js$"
      ],
      "groupName": "auth-security",
      "schedule": ["on saturday at 03:00"]
    },

    {
      "description": "차트 / 테이블 / 데이터 시각화",
      "matchPackagePatterns": [
        "^recharts$",
        "^chart.js$",
        "^react-chartjs-2$",
        "^@tanstack/react-table$",
        "^@tanstack/react-query$"
      ],
      "groupName": "charts-data",
      "schedule": ["on saturday at 03:00"]
    },

    {
      "description": "요양원 특화(서명, 달력, PDF 등)",
      "matchPackagePatterns": [
        "^react-big-calendar$",
        "^fullcalendar$",
        "^@fullcalendar/",
        "^react-signature-canvas$",
        "^react-webcam$",
        "^react-pdf$",
        "^jspdf$"
      ],
      "groupName": "healthcare-libs",
      "schedule": ["on saturday at 03:00"]
    },

    {
      "description": "개발 인프라 (devDependencies 전용)",
      "matchPackagePatterns": [
        "^husky$",
        "^lint-staged$",
        "^prettier$",
        "^eslint$",
        "^typescript$"
      ],
      "matchDepTypes": ["devDependencies"],
      "groupName": "dev-infra",
      "schedule": ["on saturday at 03:00"],
      "excludePackagePatterns": [
        "^@types/react$",
        "^@types/react-dom$"
      ]
    },

    {
      "description": "Node.js 백엔드 패키지",
      "matchPackagePatterns": [
        "^@nestjs/",
        "^nodemailer$",
        "^multer$",
        "^socket.io$",
        "^node-cron$"
      ],
      "groupName": "nodejs-server",
      "schedule": ["on saturday at 03:00"]
    },

    {
      "description": "테스팅 관련 라이브러리",
      "matchPackagePatterns": [
        "^jest$",
        "^@testing-library/",
        "^@storybook/"
      ],
      "groupName": "testing",
      "matchDepTypes": ["devDependencies"],
      "schedule": ["on saturday at 03:00"]
    }
  ],

  "lockFileMaintenance": {
    "description": "pnpm-lock.yaml 자동 유지 관리",
    "enabled": true,
    "schedule": ["on saturday at 03:00"],
    "branchTopic": "lockfile-maintenance",
    "commitMessageAction": "refresh",
    "automerge": true
  },

  "semanticCommits": "enabled",
  "commitMessagePrefix": "chore(deps): ",
  "dependencyDashboardTitle": "Agape-Care Dependency Dashboard",

  "prTitle": "chore(deps): {{#if isSingleVersion}}update {{depName}} to {{newVersion}}{{else}}update dependencies{{/if}}",

  "prBodyTemplate": "이 PR은 Agape-Care 요양원 ERP 시스템의 종속성을 업데이트합니다.\n\n{{#if hasReleaseNotes}}\n---\n\n{{{releaseNotes}}}\n{{/if}}\n\n{{#if hasWarnings}}\n---\n\n⚠️ **경고사항:**\n{{#each warnings}}\n- {{this}}\n{{/each}}\n{{/if}}",

  "vulnerabilityAlerts": {
    "description": "보안 취약점 알림 활성화",
    "enabled": true,
    "schedule": ["at any time"],
    "automerge": false
  }
}
