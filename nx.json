{
  "$schema": "./node_modules/nx/schemas/nx-schema.json",
  "description": "Agape-Care 요양원 ERP 모노레포 Nx 워크스페이스 설정",
  "extends": "nx/presets/npm.json",
  "defaultBase": "main",

  "namedInputs": {
    "default": [
      "{projectRoot}/**/*",
      "sharedGlobals"
    ],
    "production": [
      "default",
      "!{projectRoot}/**/*.spec.{ts,tsx,js,jsx}",
      "!{projectRoot}/**/*.test.{ts,tsx,js,jsx}",
      "!{projectRoot}/**/*.stories.{ts,tsx,js,jsx}",
      "!{projectRoot}/**/*.mdx",
      "!{projectRoot}/tsconfig.spec.json",
      "!{projectRoot}/jest.config.{js,ts}",
      "!{projectRoot}/vitest.config.{js,ts}",
      "!{projectRoot}/playwright.config.{js,ts}",
      "!{projectRoot}/.eslintrc.json",
      "!{projectRoot}/coverage/**",
      "!{projectRoot}/test-results/**",
      "!{projectRoot}/playwright-report/**",
      "!{projectRoot}/.storybook/**",
      "!{projectRoot}/**/.storybook/**",
      "!{projectRoot}/dist/**",
      "!{projectRoot}/build/**",
      "!{projectRoot}/.next/**",
      "!{projectRoot}/out/**"
    ],
    "sharedGlobals": [
      "{workspaceRoot}/.env",
      "{workspaceRoot}/.env.local",
      "{workspaceRoot}/.env.production",
      "{workspaceRoot}/.env.development",
      "{workspaceRoot}/tsconfig.base.json",
      "{workspaceRoot}/tsconfig.json",
      "{workspaceRoot}/package.json",
      "{workspaceRoot}/pnpm-lock.yaml",
      "{workspaceRoot}/nx.json",
      "{workspaceRoot}/eslint.config.mjs",
      "{workspaceRoot}/prettier.config.mjs",
      "{workspaceRoot}/vitest.config.ts"
    ]
  },

  "targetDefaults": {
    "build": {
      "inputs": ["production", "^production"],
      "outputs": [
        "{workspaceRoot}/dist/{projectRoot}",
        "{projectRoot}/dist",
        "{projectRoot}/.next",
        "{projectRoot}/out"
      ],
      "cache": true,
      "dependsOn": ["^build"]
    },

    "dev": {
      "inputs": ["default"],
      "cache": false,
      "dependsOn": ["^build"]
    },

    "serve": {
      "inputs": ["default"],
      "cache": false,
      "dependsOn": ["^build"]
    },

    "lint": {
      "inputs": [
        "default",
        "{workspaceRoot}/eslint.config.mjs",
        "{workspaceRoot}/.eslintrc.json",
        "{projectRoot}/.eslintrc.json"
      ],
      "cache": true
    },

    "test": {
      "inputs": ["default", "^production"],
      "outputs": [
        "{projectRoot}/coverage",
        "{workspaceRoot}/coverage"
      ],
      "cache": true
    },

    "test:watch": {
      "inputs": ["default"],
      "cache": false
    },

    "type-check": {
      "inputs": [
        "default",
        "^default",
        "{workspaceRoot}/tsconfig.base.json",
        "{projectRoot}/tsconfig.json"
      ],
      "cache": true
    },

    "format": {
      "inputs": [
        "default",
        "{workspaceRoot}/prettier.config.mjs"
      ],
      "cache": false
    },

    "format:check": {
      "inputs": [
        "default",
        "{workspaceRoot}/prettier.config.mjs"
      ],
      "cache": true
    },

    "prisma:generate": {
      "inputs": [
        "{workspaceRoot}/prisma/schema.prisma",
        "{workspaceRoot}/.env"
      ],
      "outputs": [
        "{workspaceRoot}/node_modules/.prisma",
        "{workspaceRoot}/node_modules/@prisma/client"
      ],
      "cache": false
    },

    "db:generate": {
      "inputs": [
        "{workspaceRoot}/prisma/schema.prisma",
        "{workspaceRoot}/infra/database/**/*",
        "{workspaceRoot}/.env"
      ],
      "cache": false,
      "dependsOn": ["prisma:generate"]
    },

    "db:migrate": {
      "inputs": [
        "{workspaceRoot}/prisma/schema.prisma",
        "{workspaceRoot}/prisma/migrations/**/*"
      ],
      "cache": false
    },

    "db:seed": {
      "inputs": [
        "{workspaceRoot}/infra/database/init/**/*",
        "{workspaceRoot}/.env"
      ],
      "cache": false,
      "dependsOn": ["db:migrate"]
    },

    "storybook": {
      "inputs": ["default"],
      "cache": false
    },

    "build-storybook": {
      "inputs": ["default", "^production"],
      "outputs": ["{projectRoot}/storybook-static"],
      "cache": true
    }
  },

  "tasksRunnerOptions": {
    "default": {
      "runner": "nx/tasks-runners/default",
      "options": {
        "cacheableOperations": [
          "build",
          "lint",
          "test",
          "type-check",
          "format:check",
          "build-storybook"
        ],
        "parallel": 3,
        "maxParallel": 3,
        "useDaemonProcess": true,
        "skipNxCache": false,
        "cacheDirectory": ".nx/cache"
      }
    }
  },

  "affected": {
    "defaultBase": "main"
  },

  "workspaceLayout": {
    "appsDir": "apps",
    "libsDir": "packages"
  },

  "generators": {
    "@nx/react": {
      "application": {
        "babel": false,
        "bundler": "vite",
        "linter": "eslint",
        "style": "css",
        "unitTestRunner": "vitest"
      },
      "library": {
        "bundler": "vite",
        "linter": "eslint",
        "style": "css",
        "unitTestRunner": "vitest"
      }
    },
    "@nx/next": {
      "application": {
        "linter": "eslint",
        "style": "css",
        "unitTestRunner": "vitest"
      }
    },
    "@nx/node": {
      "application": {
        "linter": "eslint",
        "unitTestRunner": "vitest"
      }
    }
  },

  "nxCloudAccessToken": null,

  "parallel": 3,
  "cacheDirectory": ".nx/cache"
}
