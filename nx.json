{
  "$schema": "./node_modules/@nx/devkit/schemas/nx-schema.json",
  "description": "Nx 워크스페이스 설정 (ConnectWon Monorepo)",
  "extends": "nx/presets/npm.json",
  "defaultBase": "origin/main",

  "__comment_namedInputs": "namedInputs: 빌드 캐시 및 의존성 관리를 위한 입력 파일 집합 정의",
  "namedInputs": {
    "default": [
      "{projectRoot}/**/*",
      "!{projectRoot}/dist/**/*",
      "!{projectRoot}/build/**/*",
      "!{projectRoot}/.next/**/*"
    ],
    "production": [
      "default",
      "!{projectRoot}/**/*.spec.*",
      "!{projectRoot}/**/*.test.*",
      "!{projectRoot}/**/*.stories.*",
      "!{projectRoot}/**/*.mdx",
      "!{projectRoot}/coverage/**",
      "!{projectRoot}/playwright-report/**",
      "!{projectRoot}/generated/**",
      "!{projectRoot}/dist/**/*"
    ],
    "env": [
      "{workspaceRoot}/.env*",
      "{workspaceRoot}/infra/docker/.env",
      "{workspaceRoot}/secrets/**",
      "{projectRoot}/.env*"
    ]
  },

  "__comment_targetDefaults": "targetDefaults: Nx 작업 단위별 기본 입력, 출력, 캐싱, 의존성 및 환경 설정",
  "targetDefaults": {
    "build": {
      "inputs": ["production", "^production", "env"],
      "outputs": ["{workspaceRoot}/dist", "{projectRoot}/.next"],
      "cache": true,
      "dependsOn": ["^build"],
      "envFile": ".env",
      "configurations": {
        "admin": {
          "env": {
            "NEXT_PUBLIC_APP_TYPE": "admin",
            "NEXT_PUBLIC_ENV_MODE": "production"
          }
        },
        "web": {
          "env": {
            "NEXT_PUBLIC_APP_TYPE": "web",
            "NEXT_PUBLIC_ENV_MODE": "production"
          }
        },
        "development": {
          "env": {
            "NEXT_PUBLIC_ENV_MODE": "development"
          }
        }
      }
    },
    "dev": {
      "inputs": ["default"],
      "cache": false,
      "envFile": ".env",
      "configurations": {
        "admin": {
          "env": {
            "NEXT_PUBLIC_APP_TYPE": "admin",
            "NEXT_PUBLIC_ENV_MODE": "development"
          }
        },
        "web": {
          "env": {
            "NEXT_PUBLIC_APP_TYPE": "web",
            "NEXT_PUBLIC_ENV_MODE": "development"
          }
        }
      }
    },
    "lint": {
      "inputs": ["default"],
      "cache": true
    },
    "test": {
      "inputs": ["default"],
      "cache": true,
      "envFile": ".env"
    },
    "e2e": {
      "inputs": ["default"],
      "cache": false,
      "envFile": ".env"
    },
    "gen:openapi": {
      "inputs": ["production", "^production"],
      "outputs": ["{projectRoot}/openapi.json"],
      "cache": true
    },
    "prisma:generate": {
      "inputs": ["default", "^default", "env"],
      "cache": false,
      "envFile": ".env"
    },
    "db:generate": {
      "inputs": ["default", "^default", "env"],
      "cache": false,
      "envFile": ".env"
    },
    "type-check": {
      "inputs": ["default", "^default"],
      "cache": true
    },
    "format": {
      "inputs": ["default"],
      "cache": false
    },
    "ci": {
      "inputs": ["production", "^production", "env"],
      "cache": false,
      "envFile": ".env"
    }
  },

  "__comment_tasksRunnerOptions": "tasksRunnerOptions: 병렬 처리, 캐시, Daemon 등 실행 최적화 설정",
  "tasksRunnerOptions": {
    "default": {
      "runner": "nx/tasks-runners/default",
      "options": {
        "cacheableOperations": [
          "build",
          "lint",
          "test",
          "type-check",
          "gen:openapi"
        ],
        "parallel": 4,
        "maxParallel": 4,
        "useDaemonProcess": false,
        "skipNxCache": false,
        "cacheDirectory": ".nx/cache"
      }
    }
  },

  "__comment_pluginsConfig": "pluginsConfig: Nx에서 사용하는 빌드 및 검사 플러그인 설정",
  "pluginsConfig": {
    "@nx/js": {},
    "@nx/web": {}
  },

  "__comment_workspaceLayout": "workspaceLayout: 워크스페이스 내 앱/패키지 디렉터리 구조 정의",
  "workspaceLayout": {
    "appsDir": "apps",
    "libsDir": "packages"
  },

  "__comment_generators": "generators: 코드 생성 시 기본 옵션 설정",
  "generators": {
    "@nx/react": {
      "application": {
        "babel": true
      }
    },
    "@nx/next": {
      "application": {
        "linter": "eslint"
      }
    }
  }
}
